[{"url":"https://api.github.com/repos/karant-dev/AutoRedact/pulls/comments/2616015865","pull_request_review_id":3574127511,"id":2616015865,"node_id":"PRRC_kwDOQm3mwc6b7Tv5","diff_hunk":"@@ -0,0 +1,214 @@\n+import { createWorker } from 'tesseract.js';\n+import type { DetectedItem, DetectionSettings } from '../types';\n+import type { ICanvasFactory, AbstractImage } from './interfaces';\n+import { preprocessImage } from './image-processing';\n+import {\n+    findMatches,\n+    findBlockWordMatches,\n+    findCustomDateMatches,\n+    findCustomRegexMatches,\n+    filterAllowlistedMatches,\n+    hasValidOverlap\n+} from './matcher';\n+import { SENSITIVE_PATTERNS } from '../constants/patterns';\n+import { DEFAULT_ALLOWLIST } from '../constants/config';\n+\n+// Default settings\n+const DEFAULT_DETECTION_SETTINGS: DetectionSettings = {\n+    email: true,\n+    ip: true,\n+    creditCard: true,\n+    secret: true,\n+    pii: true,\n+    allowlist: DEFAULT_ALLOWLIST,\n+    blockWords: [],\n+    customDates: [],\n+    customRegex: [],\n+};\n+\n+export interface ProcessImageOptions {\n+    canvasFactory: ICanvasFactory;\n+    onProgress?: (progress: number) => void;\n+    detectionSettings?: DetectionSettings;\n+}\n+\n+export interface ScanResult {\n+    detectedCount: number;\n+    detectedBreakdown: {\n+        emails: number;\n+        ips: number;\n+        creditCards: number;\n+        secrets: number;\n+        pii: number;\n+    };\n+    dataUrl: string;\n+}\n+\n+export const processImage = async (\n+    source: string | Blob | File,\n+    options: ProcessImageOptions\n+): Promise<ScanResult> => {\n+    const {\n+        canvasFactory,\n+        onProgress,\n+        detectionSettings = DEFAULT_DETECTION_SETTINGS\n+    } = options;\n+\n+    // 1. Load Image using Adapter\n+    // Returns an abstract image object (HTMLImageElement in browser, Image in node-canvas)\n+    const img = await canvasFactory.loadImage(source);\n+\n+    // 2. Prepare Canvas Dimensions (Upscale 2x for OCR)\n+    const scale = 2;\n+    // In BrowserAdapter, img has naturalWidth/Height. In Node, it acts similarly.\n+    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n+    const width = (img as any).naturalWidth || (img as any).width;\n+    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n+    const height = (img as any).naturalHeight || (img as any).height;\n+\n+    const upscaledW = width * scale;\n+    const upscaledH = height * scale;\n+\n+    // 3. Create Canvases\n+    const upscaledCanvas = canvasFactory.createCanvas(upscaledW, upscaledH);\n+    const upscaledCtx = upscaledCanvas.getContext('2d');\n+\n+    const ocrCanvas = canvasFactory.createCanvas(upscaledW, upscaledH);\n+    const ocrCtx = ocrCanvas.getContext('2d');\n+\n+    if (!upscaledCtx || !ocrCtx) {\n+        throw new Error('Failed to create canvas contexts');\n+    }\n+\n+    // 4. Draw & Preprocess\n+    // Layer 1: Draw original to upscaled (Color version)\n+    upscaledCtx.drawImage(img, 0, 0, upscaledW, upscaledH);\n+\n+    // Layer 2: Copy to OCR canvas\n+    ocrCtx.drawImage(upscaledCanvas as unknown as AbstractImage, 0, 0);\n+\n+    // Layer 3: Apply Preprocessing (B&W) to OCR canvas only\n+    preprocessImage(ocrCtx, upscaledW, upscaledH);\n+    const ocrUrl = ocrCanvas.toDataURL('image/png');\n+\n+    // 5. Run Tesseract (WASM/Node)\n+    const worker = await createWorker('eng', 1, {\n+        logger: (m) => {\n+            if (m.status === 'recognizing text' && onProgress) {\n+                onProgress(m.progress * 100);\n+            }\n+        },\n+    });\n+\n+    const result = await worker.recognize(ocrUrl, {}, { blocks: true });\n+\n+    // 6. Detection Logic\n+    const detected: DetectedItem[] = [];\n+    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n+    const data = result.data as any;\n+    const fullText = data.text || '';\n+\n+    // --- MATCHING LOGIC (Copied from utils/ocr.ts) ---\n+    const emailMatches = detectionSettings.email ? findMatches(SENSITIVE_PATTERNS.email, fullText, 'email') : [];\n+\n+    const ipv4Matches = detectionSettings.ip ? findMatches(SENSITIVE_PATTERNS.ipv4, fullText, 'ip').filter(m => m.text.split('.').length === 4) : [];\n+    const ipv6Matches = detectionSettings.ip ? findMatches(SENSITIVE_PATTERNS.ipv6, fullText, 'ip') : [];\n+    const macMatches = detectionSettings.ip ? findMatches(SENSITIVE_PATTERNS.mac, fullText, 'ip') : [];\n+    const ipMatches = [...ipv4Matches, ...ipv6Matches, ...macMatches];\n+\n+    const ccBasicMatches = detectionSettings.creditCard ? findMatches(SENSITIVE_PATTERNS.creditCard, fullText, 'creditCard') : [];\n+    const ibanMatches = detectionSettings.creditCard ? findMatches(SENSITIVE_PATTERNS.iban, fullText, 'creditCard') : [];\n+    const btcMatches = detectionSettings.creditCard ? findMatches(SENSITIVE_PATTERNS.bitcoin, fullText, 'creditCard') : [];\n+    const ccMatches = [...ccBasicMatches, ...ibanMatches, ...btcMatches];\n+\n+    const ssnMatches = detectionSettings.pii ? findMatches(SENSITIVE_PATTERNS.ssn, fullText, 'pii') : [];\n+    const panMatches = detectionSettings.pii ? findMatches(SENSITIVE_PATTERNS.pan, fullText, 'pii') : [];\n+    const piiMatches = [...ssnMatches, ...panMatches];\n+\n+    let secretMatches: Array<{ text: string, type: DetectedItem['type'], index: number }> = [];\n+    if (detectionSettings.secret) {\n+        SENSITIVE_PATTERNS.secrets.forEach(pattern => {\n+            secretMatches = [...secretMatches, ...findMatches(pattern, fullText, 'secret')];\n+        });\n+    }\n+\n+    const blockWordMatches = detectionSettings.blockWords ? findBlockWordMatches(detectionSettings.blockWords, fullText, 'pii') : [];\n+    const customDateMatches = detectionSettings.customDates ? findCustomDateMatches(detectionSettings.customDates, fullText, 'pii') : [];\n+    const customRegexMatches = detectionSettings.customRegex ? findCustomRegexMatches(detectionSettings.customRegex, fullText, 'pii') : [];","path":"src/core/processor.ts","commit_id":"fcf829233be16c2f5dac0353770a5550acd5b647","original_commit_id":"fcf829233be16c2f5dac0353770a5550acd5b647","user":{"login":"Copilot","id":175728472,"node_id":"BOT_kgDOCnlnWA","avatar_url":"https://avatars.githubusercontent.com/in/946600?v=4","gravatar_id":"","url":"https://api.github.com/users/Copilot","html_url":"https://github.com/apps/copilot-pull-request-reviewer","followers_url":"https://api.github.com/users/Copilot/followers","following_url":"https://api.github.com/users/Copilot/following{/other_user}","gists_url":"https://api.github.com/users/Copilot/gists{/gist_id}","starred_url":"https://api.github.com/users/Copilot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Copilot/subscriptions","organizations_url":"https://api.github.com/users/Copilot/orgs","repos_url":"https://api.github.com/users/Copilot/repos","events_url":"https://api.github.com/users/Copilot/events{/privacy}","received_events_url":"https://api.github.com/users/Copilot/received_events","type":"Bot","user_view_type":"public","site_admin":false},"body":"The conditional check for blockWords, customDates, and customRegex is incorrect. These properties are arrays that could be empty but still exist (empty arrays are truthy). The check should verify if the arrays have elements, not just if they exist. Use `detectionSettings.blockWords?.length`, `detectionSettings.customDates?.length`, and `detectionSettings.customRegex?.length` instead to avoid processing empty arrays unnecessarily.\n```suggestion\n    const blockWordMatches = detectionSettings.blockWords?.length ? findBlockWordMatches(detectionSettings.blockWords, fullText, 'pii') : [];\n    const customDateMatches = detectionSettings.customDates?.length ? findCustomDateMatches(detectionSettings.customDates, fullText, 'pii') : [];\n    const customRegexMatches = detectionSettings.customRegex?.length ? findCustomRegexMatches(detectionSettings.customRegex, fullText, 'pii') : [];\n```","created_at":"2025-12-13T02:59:47Z","updated_at":"2025-12-13T02:59:50Z","html_url":"https://github.com/karant-dev/AutoRedact/pull/21#discussion_r2616015865","pull_request_url":"https://api.github.com/repos/karant-dev/AutoRedact/pulls/21","_links":{"self":{"href":"https://api.github.com/repos/karant-dev/AutoRedact/pulls/comments/2616015865"},"html":{"href":"https://github.com/karant-dev/AutoRedact/pull/21#discussion_r2616015865"},"pull_request":{"href":"https://api.github.com/repos/karant-dev/AutoRedact/pulls/21"}},"reactions":{"url":"https://api.github.com/repos/karant-dev/AutoRedact/pulls/comments/2616015865/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"start_line":135,"original_start_line":135,"start_side":"RIGHT","line":137,"original_line":137,"side":"RIGHT","author_association":"NONE","original_position":137,"position":137,"subject_type":"line"},{"url":"https://api.github.com/repos/karant-dev/AutoRedact/pulls/comments/2616015868","pull_request_review_id":3574127511,"id":2616015868,"node_id":"PRRC_kwDOQm3mwc6b7Tv8","diff_hunk":"@@ -0,0 +1,214 @@\n+import { createWorker } from 'tesseract.js';\n+import type { DetectedItem, DetectionSettings } from '../types';\n+import type { ICanvasFactory, AbstractImage } from './interfaces';\n+import { preprocessImage } from './image-processing';\n+import {\n+    findMatches,\n+    findBlockWordMatches,\n+    findCustomDateMatches,\n+    findCustomRegexMatches,\n+    filterAllowlistedMatches,\n+    hasValidOverlap\n+} from './matcher';\n+import { SENSITIVE_PATTERNS } from '../constants/patterns';\n+import { DEFAULT_ALLOWLIST } from '../constants/config';\n+\n+// Default settings\n+const DEFAULT_DETECTION_SETTINGS: DetectionSettings = {\n+    email: true,\n+    ip: true,\n+    creditCard: true,\n+    secret: true,\n+    pii: true,\n+    allowlist: DEFAULT_ALLOWLIST,\n+    blockWords: [],\n+    customDates: [],\n+    customRegex: [],\n+};\n+\n+export interface ProcessImageOptions {\n+    canvasFactory: ICanvasFactory;\n+    onProgress?: (progress: number) => void;\n+    detectionSettings?: DetectionSettings;\n+}\n+\n+export interface ScanResult {\n+    detectedCount: number;\n+    detectedBreakdown: {\n+        emails: number;\n+        ips: number;\n+        creditCards: number;\n+        secrets: number;\n+        pii: number;\n+    };\n+    dataUrl: string;\n+}\n+\n+export const processImage = async (\n+    source: string | Blob | File,\n+    options: ProcessImageOptions\n+): Promise<ScanResult> => {\n+    const {\n+        canvasFactory,\n+        onProgress,\n+        detectionSettings = DEFAULT_DETECTION_SETTINGS\n+    } = options;\n+\n+    // 1. Load Image using Adapter\n+    // Returns an abstract image object (HTMLImageElement in browser, Image in node-canvas)\n+    const img = await canvasFactory.loadImage(source);\n+\n+    // 2. Prepare Canvas Dimensions (Upscale 2x for OCR)\n+    const scale = 2;\n+    // In BrowserAdapter, img has naturalWidth/Height. In Node, it acts similarly.\n+    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n+    const width = (img as any).naturalWidth || (img as any).width;\n+    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n+    const height = (img as any).naturalHeight || (img as any).height;\n+","path":"src/core/processor.ts","commit_id":"fcf829233be16c2f5dac0353770a5550acd5b647","original_commit_id":"fcf829233be16c2f5dac0353770a5550acd5b647","user":{"login":"Copilot","id":175728472,"node_id":"BOT_kgDOCnlnWA","avatar_url":"https://avatars.githubusercontent.com/in/946600?v=4","gravatar_id":"","url":"https://api.github.com/users/Copilot","html_url":"https://github.com/apps/copilot-pull-request-reviewer","followers_url":"https://api.github.com/users/Copilot/followers","following_url":"https://api.github.com/users/Copilot/following{/other_user}","gists_url":"https://api.github.com/users/Copilot/gists{/gist_id}","starred_url":"https://api.github.com/users/Copilot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Copilot/subscriptions","organizations_url":"https://api.github.com/users/Copilot/orgs","repos_url":"https://api.github.com/users/Copilot/repos","events_url":"https://api.github.com/users/Copilot/events{/privacy}","received_events_url":"https://api.github.com/users/Copilot/received_events","type":"Bot","user_view_type":"public","site_admin":false},"body":"Unsafe type casting with fallback. The code uses `(img as any).naturalWidth || (img as any).width` to handle different image types, but this doesn't validate that either property exists or is a valid number. If both properties are undefined or 0, the canvas will be created with invalid dimensions (0 or NaN), leading to potential runtime errors. Consider adding explicit validation to ensure width and height are positive numbers.\n```suggestion\n\n    // Validate width and height\n    if (\n        !Number.isFinite(width) || width <= 0 ||\n        !Number.isFinite(height) || height <= 0\n    ) {\n        throw new Error('Invalid image dimensions: width and height must be positive numbers');\n    }\n```","created_at":"2025-12-13T02:59:47Z","updated_at":"2025-12-13T02:59:50Z","html_url":"https://github.com/karant-dev/AutoRedact/pull/21#discussion_r2616015868","pull_request_url":"https://api.github.com/repos/karant-dev/AutoRedact/pulls/21","_links":{"self":{"href":"https://api.github.com/repos/karant-dev/AutoRedact/pulls/comments/2616015868"},"html":{"href":"https://github.com/karant-dev/AutoRedact/pull/21#discussion_r2616015868"},"pull_request":{"href":"https://api.github.com/repos/karant-dev/AutoRedact/pulls/21"}},"reactions":{"url":"https://api.github.com/repos/karant-dev/AutoRedact/pulls/comments/2616015868/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"start_line":null,"original_start_line":null,"start_side":null,"line":68,"original_line":68,"side":"RIGHT","author_association":"NONE","original_position":68,"position":68,"subject_type":"line"},{"url":"https://api.github.com/repos/karant-dev/AutoRedact/pulls/comments/2616015871","pull_request_review_id":3574127511,"id":2616015871,"node_id":"PRRC_kwDOQm3mwc6b7Tv_","diff_hunk":"@@ -0,0 +1,24 @@\n+\n+// Abstract image type (Platform dependent: HTMLImageElement or Node Canvas Image)\n+export type AbstractImage = unknown;\n+","path":"src/core/interfaces.ts","commit_id":"fcf829233be16c2f5dac0353770a5550acd5b647","original_commit_id":"fcf829233be16c2f5dac0353770a5550acd5b647","user":{"login":"Copilot","id":175728472,"node_id":"BOT_kgDOCnlnWA","avatar_url":"https://avatars.githubusercontent.com/in/946600?v=4","gravatar_id":"","url":"https://api.github.com/users/Copilot","html_url":"https://github.com/apps/copilot-pull-request-reviewer","followers_url":"https://api.github.com/users/Copilot/followers","following_url":"https://api.github.com/users/Copilot/following{/other_user}","gists_url":"https://api.github.com/users/Copilot/gists{/gist_id}","starred_url":"https://api.github.com/users/Copilot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Copilot/subscriptions","organizations_url":"https://api.github.com/users/Copilot/orgs","repos_url":"https://api.github.com/users/Copilot/repos","events_url":"https://api.github.com/users/Copilot/events{/privacy}","received_events_url":"https://api.github.com/users/Copilot/received_events","type":"Bot","user_view_type":"public","site_admin":false},"body":"The AbstractImage type is defined as `unknown`, which provides no type safety. This forces unsafe type assertions throughout the codebase (e.g., lines 65-67 in processor.ts and line 88). Consider using a union type or generic parameter to preserve type information while maintaining flexibility across platforms, e.g., `type AbstractImage = HTMLImageElement | NodeCanvas.Image`.\n```suggestion\n\n// Minimal NodeCanvas.Image type declaration for type safety in Node.js environments\n// Remove or replace this with an import if you have @types/canvas installed\ndeclare namespace NodeCanvas {\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    type Image = any;\n}\n\nexport type AbstractImage = HTMLImageElement | NodeCanvas.Image;\n```","created_at":"2025-12-13T02:59:48Z","updated_at":"2025-12-13T02:59:50Z","html_url":"https://github.com/karant-dev/AutoRedact/pull/21#discussion_r2616015871","pull_request_url":"https://api.github.com/repos/karant-dev/AutoRedact/pulls/21","_links":{"self":{"href":"https://api.github.com/repos/karant-dev/AutoRedact/pulls/comments/2616015871"},"html":{"href":"https://github.com/karant-dev/AutoRedact/pull/21#discussion_r2616015871"},"pull_request":{"href":"https://api.github.com/repos/karant-dev/AutoRedact/pulls/21"}},"reactions":{"url":"https://api.github.com/repos/karant-dev/AutoRedact/pulls/comments/2616015871/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"start_line":3,"original_start_line":3,"start_side":"RIGHT","line":4,"original_line":4,"side":"RIGHT","author_association":"NONE","original_position":4,"position":4,"subject_type":"line"},{"url":"https://api.github.com/repos/karant-dev/AutoRedact/pulls/comments/2616015872","pull_request_review_id":3574127511,"id":2616015872,"node_id":"PRRC_kwDOQm3mwc6b7TwA","diff_hunk":"@@ -0,0 +1,30 @@\n+import type { ICanvasFactory, ICanvas, AbstractImage } from '../core/interfaces';\n+\n+export class BrowserCanvasAdapter implements ICanvasFactory {\n+    createCanvas(width: number, height: number): ICanvas {\n+        const canvas = document.createElement('canvas');\n+        canvas.width = width;\n+        canvas.height = height;\n+        return canvas as unknown as ICanvas; // HTMLCanvasElement satisfies ICanvas structure\n+    }\n+\n+    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n+    loadImage(source: string | any): Promise<AbstractImage> {\n+        return new Promise((resolve, reject) => {\n+            const img = new Image();\n+            if (typeof source === 'string') {\n+                img.src = source;\n+                // eslint-disable-next-line @typescript-eslint/no-explicit-any\n+            } else if ((source as any) instanceof Blob || (source as any) instanceof File) {\n+                // eslint-disable-next-line @typescript-eslint/no-explicit-any\n+                img.src = URL.createObjectURL(source as any);\n+            } else {\n+                reject(new Error('Invalid source type'));\n+                return;\n+            }\n+\n+            img.onload = () => resolve(img);\n+            img.onerror = () => reject(new Error('Failed to load image'));","path":"src/adapters/BrowserCanvasAdapter.ts","commit_id":"fcf829233be16c2f5dac0353770a5550acd5b647","original_commit_id":"fcf829233be16c2f5dac0353770a5550acd5b647","user":{"login":"Copilot","id":175728472,"node_id":"BOT_kgDOCnlnWA","avatar_url":"https://avatars.githubusercontent.com/in/946600?v=4","gravatar_id":"","url":"https://api.github.com/users/Copilot","html_url":"https://github.com/apps/copilot-pull-request-reviewer","followers_url":"https://api.github.com/users/Copilot/followers","following_url":"https://api.github.com/users/Copilot/following{/other_user}","gists_url":"https://api.github.com/users/Copilot/gists{/gist_id}","starred_url":"https://api.github.com/users/Copilot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Copilot/subscriptions","organizations_url":"https://api.github.com/users/Copilot/orgs","repos_url":"https://api.github.com/users/Copilot/repos","events_url":"https://api.github.com/users/Copilot/events{/privacy}","received_events_url":"https://api.github.com/users/Copilot/received_events","type":"Bot","user_view_type":"public","site_admin":false},"body":"Memory leak risk: When loading an image from a Blob or File, URL.createObjectURL is called but the created URL is never revoked. This will leak memory if many images are processed. Consider adding URL.revokeObjectURL after the image loads successfully or fails.\n```suggestion\n            let objectUrl: string | null = null;\n            if (typeof source === 'string') {\n                img.src = source;\n                // eslint-disable-next-line @typescript-eslint/no-explicit-any\n            } else if ((source as any) instanceof Blob || (source as any) instanceof File) {\n                // eslint-disable-next-line @typescript-eslint/no-explicit-any\n                objectUrl = URL.createObjectURL(source as any);\n                img.src = objectUrl;\n            } else {\n                reject(new Error('Invalid source type'));\n                return;\n            }\n\n            img.onload = () => {\n                if (objectUrl) {\n                    URL.revokeObjectURL(objectUrl);\n                }\n                resolve(img);\n            };\n            img.onerror = () => {\n                if (objectUrl) {\n                    URL.revokeObjectURL(objectUrl);\n                }\n                reject(new Error('Failed to load image'));\n            };\n```","created_at":"2025-12-13T02:59:48Z","updated_at":"2025-12-13T02:59:50Z","html_url":"https://github.com/karant-dev/AutoRedact/pull/21#discussion_r2616015872","pull_request_url":"https://api.github.com/repos/karant-dev/AutoRedact/pulls/21","_links":{"self":{"href":"https://api.github.com/repos/karant-dev/AutoRedact/pulls/comments/2616015872"},"html":{"href":"https://github.com/karant-dev/AutoRedact/pull/21#discussion_r2616015872"},"pull_request":{"href":"https://api.github.com/repos/karant-dev/AutoRedact/pulls/21"}},"reactions":{"url":"https://api.github.com/repos/karant-dev/AutoRedact/pulls/comments/2616015872/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"start_line":15,"original_start_line":15,"start_side":"RIGHT","line":27,"original_line":27,"side":"RIGHT","author_association":"NONE","original_position":27,"position":27,"subject_type":"line"},{"url":"https://api.github.com/repos/karant-dev/AutoRedact/pulls/comments/2616015875","pull_request_review_id":3574127511,"id":2616015875,"node_id":"PRRC_kwDOQm3mwc6b7TwD","diff_hunk":"@@ -18,6 +18,9 @@\n     ]\n   },\n   \"dependencies\": {\n+    \"canvas\": \"^3.2.0\",\n+    \"chalk\": \"^5.6.2\",\n+    \"commander\": \"^14.0.2\",","path":"package.json","commit_id":"fcf829233be16c2f5dac0353770a5550acd5b647","original_commit_id":"fcf829233be16c2f5dac0353770a5550acd5b647","user":{"login":"Copilot","id":175728472,"node_id":"BOT_kgDOCnlnWA","avatar_url":"https://avatars.githubusercontent.com/in/946600?v=4","gravatar_id":"","url":"https://api.github.com/users/Copilot","html_url":"https://github.com/apps/copilot-pull-request-reviewer","followers_url":"https://api.github.com/users/Copilot/followers","following_url":"https://api.github.com/users/Copilot/following{/other_user}","gists_url":"https://api.github.com/users/Copilot/gists{/gist_id}","starred_url":"https://api.github.com/users/Copilot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Copilot/subscriptions","organizations_url":"https://api.github.com/users/Copilot/orgs","repos_url":"https://api.github.com/users/Copilot/repos","events_url":"https://api.github.com/users/Copilot/events{/privacy}","received_events_url":"https://api.github.com/users/Copilot/received_events","type":"Bot","user_view_type":"public","site_admin":false},"body":"Commander version 14.0.2 requires Node.js >=20, as stated in the package-lock.json. This should be documented in the README or package.json engines field to prevent runtime issues for users with older Node versions. Consider adding an \"engines\" field specifying the minimum Node version.","created_at":"2025-12-13T02:59:48Z","updated_at":"2025-12-13T02:59:51Z","html_url":"https://github.com/karant-dev/AutoRedact/pull/21#discussion_r2616015875","pull_request_url":"https://api.github.com/repos/karant-dev/AutoRedact/pulls/21","_links":{"self":{"href":"https://api.github.com/repos/karant-dev/AutoRedact/pulls/comments/2616015875"},"html":{"href":"https://github.com/karant-dev/AutoRedact/pull/21#discussion_r2616015875"},"pull_request":{"href":"https://api.github.com/repos/karant-dev/AutoRedact/pulls/21"}},"reactions":{"url":"https://api.github.com/repos/karant-dev/AutoRedact/pulls/comments/2616015875/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"start_line":null,"original_start_line":null,"start_side":null,"line":23,"original_line":23,"side":"RIGHT","author_association":"NONE","original_position":18,"position":18,"subject_type":"line"},{"url":"https://api.github.com/repos/karant-dev/AutoRedact/pulls/comments/2616015878","pull_request_review_id":3574127511,"id":2616015878,"node_id":"PRRC_kwDOQm3mwc6b7TwG","diff_hunk":"@@ -0,0 +1,125 @@\n+#!/usr/bin/env node\n+\n+import { Command } from 'commander';\n+import chalk from 'chalk';\n+import path from 'path';\n+import fs from 'fs';\n+import { NodeCanvasAdapter } from './adapters/NodeCanvasAdapter';\n+import { processImage } from './core/processor';\n+import { DEFAULT_ALLOWLIST } from './constants/config';\n+import type { DetectionSettings } from './types';\n+\n+const program = new Command();\n+\n+program\n+    .name('auto-redact')\n+    .description('CLI for AutoRedact - Privacy-First OCR Redaction')\n+    .version('1.0.0');","path":"src/cli.ts","commit_id":"fcf829233be16c2f5dac0353770a5550acd5b647","original_commit_id":"fcf829233be16c2f5dac0353770a5550acd5b647","user":{"login":"Copilot","id":175728472,"node_id":"BOT_kgDOCnlnWA","avatar_url":"https://avatars.githubusercontent.com/in/946600?v=4","gravatar_id":"","url":"https://api.github.com/users/Copilot","html_url":"https://github.com/apps/copilot-pull-request-reviewer","followers_url":"https://api.github.com/users/Copilot/followers","following_url":"https://api.github.com/users/Copilot/following{/other_user}","gists_url":"https://api.github.com/users/Copilot/gists{/gist_id}","starred_url":"https://api.github.com/users/Copilot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Copilot/subscriptions","organizations_url":"https://api.github.com/users/Copilot/orgs","repos_url":"https://api.github.com/users/Copilot/repos","events_url":"https://api.github.com/users/Copilot/events{/privacy}","received_events_url":"https://api.github.com/users/Copilot/received_events","type":"Bot","user_view_type":"public","site_admin":false},"body":"Version mismatch: The CLI hardcodes version \"1.0.0\" but package.json shows version \"1.1.0\". The version should be dynamically imported from package.json to maintain consistency and avoid manual updates in multiple places.","created_at":"2025-12-13T02:59:48Z","updated_at":"2025-12-13T02:59:51Z","html_url":"https://github.com/karant-dev/AutoRedact/pull/21#discussion_r2616015878","pull_request_url":"https://api.github.com/repos/karant-dev/AutoRedact/pulls/21","_links":{"self":{"href":"https://api.github.com/repos/karant-dev/AutoRedact/pulls/comments/2616015878"},"html":{"href":"https://github.com/karant-dev/AutoRedact/pull/21#discussion_r2616015878"},"pull_request":{"href":"https://api.github.com/repos/karant-dev/AutoRedact/pulls/21"}},"reactions":{"url":"https://api.github.com/repos/karant-dev/AutoRedact/pulls/comments/2616015878/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"start_line":null,"original_start_line":null,"start_side":null,"line":17,"original_line":17,"side":"RIGHT","author_association":"NONE","original_position":17,"position":17,"subject_type":"line"},{"url":"https://api.github.com/repos/karant-dev/AutoRedact/pulls/comments/2616015880","pull_request_review_id":3574127511,"id":2616015880,"node_id":"PRRC_kwDOQm3mwc6b7TwI","diff_hunk":"@@ -0,0 +1,125 @@\n+#!/usr/bin/env node\n+\n+import { Command } from 'commander';\n+import chalk from 'chalk';\n+import path from 'path';\n+import fs from 'fs';\n+import { NodeCanvasAdapter } from './adapters/NodeCanvasAdapter';\n+import { processImage } from './core/processor';\n+import { DEFAULT_ALLOWLIST } from './constants/config';\n+import type { DetectionSettings } from './types';\n+\n+const program = new Command();\n+\n+program\n+    .name('auto-redact')\n+    .description('CLI for AutoRedact - Privacy-First OCR Redaction')\n+    .version('1.0.0');\n+\n+program\n+    .argument('<input>', 'Input image path')\n+    .option('-o, --output <path>', 'Output image path (default: redacted-<input>)')\n+    .option('--no-emails', 'Disable Email Redaction')\n+    .option('--no-ips', 'Disable IP Redaction')\n+    .option('--no-credit-cards', 'Disable Credit Card Redaction')\n+    .option('--no-secrets', 'Disable Secret/Key Redaction')\n+    .option('--no-pii', 'Disable PII Redaction')\n+    .option('--allowlist <items>', 'Comma separated list of allowed items')\n+    .option('--block-words <items>', 'Comma separated list of words to block')\n+    .option('--custom-dates <items>', 'Comma separated list of date formats')\n+    .option('--custom-regex <pattern...>', 'Custom Regex Pattern (can be repeated)')\n+    .action(async (inputPath, options) => {\n+        try {\n+            console.log(chalk.blue(`Processing: ${inputPath}...`));\n+\n+            // Fix for 'npm run': Resolve path relative to where the user actually ran the command (INIT_CWD),\n+            // not the project root where npm executes the script.\n+            const currentDir = process.env.INIT_CWD || process.cwd();\n+            const absoluteInputPath = path.resolve(currentDir, inputPath);\n+\n+            if (!fs.existsSync(absoluteInputPath)) {\n+                console.error(chalk.red(`Error: Input file detection failed at ${absoluteInputPath} (Original: ${inputPath})`));\n+                process.exit(1);\n+            }\n+\n+            const adapter = new NodeCanvasAdapter();\n+\n+            // Parse lists\n+            const allowlist = options.allowlist\n+                ? options.allowlist.split(',').map((s: string) => s.trim())\n+                : DEFAULT_ALLOWLIST;\n+\n+            const blockWords = options.blockWords\n+                ? options.blockWords.split(',').map((s: string) => s.trim())\n+                : [];\n+\n+            const customDates = options.customDates\n+                ? options.customDates.split(',').map((s: string) => s.trim())\n+                : [];\n+\n+            // Parse Custom Regex (Repeatable flag)\n+            // Commander 7+ handles variadic args if specified, or we might need to handle it differently depending on version.\n+            // Assuming string[] if repeated, or string if once.\n+            let customRegexRules: DetectionSettings['customRegex'] = [];\n+            if (options.customRegex) {\n+                const patterns = Array.isArray(options.customRegex) ? options.customRegex : [options.customRegex];\n+                customRegexRules = patterns.map((p: string, i: number) => ({\n+                    id: `cli-${i}`,\n+                    pattern: p,\n+                    caseSensitive: false, // Default to case-insensitive for CLI\n+                    label: `Custom Rule ${i + 1}`\n+                }));\n+            }\n+\n+            const result = await processImage(absoluteInputPath, {\n+                canvasFactory: adapter,\n+                detectionSettings: {\n+                    email: options.emails,\n+                    ip: options.ips,\n+                    creditCard: options.creditCards,\n+                    secret: options.secrets,\n+                    pii: options.pii,\n+                    allowlist: allowlist,\n+                    blockWords: blockWords,\n+                    customDates: customDates,\n+                    customRegex: customRegexRules\n+                },\n+                onProgress: (p) => {\n+                    process.stdout.write(`\\rOCR Progress: ${Math.round(p)}%`);\n+                }\n+            });\n+\n+            console.log(chalk.green('\\n\\nRedaction Complete! ✅'));\n+            console.log('--------------------------------');\n+            console.log(`Emails Found:       ${result.detectedBreakdown.emails}`);\n+            console.log(`IPs Found:          ${result.detectedBreakdown.ips}`);\n+            console.log(`Credit Cards Found: ${result.detectedBreakdown.creditCards}`);\n+            console.log(`Secrets Found:      ${result.detectedBreakdown.secrets}`);\n+            console.log(`PII/Other Found:    ${result.detectedBreakdown.pii}`);\n+            console.log('--------------------------------');\n+\n+            // Save Output\n+            let outputPath = options.output;\n+            if (outputPath) {\n+                // Fix for 'npm run': Resolve relative output path against user's CWD\n+                outputPath = path.resolve(currentDir, outputPath);\n+            } else {\n+                const dir = path.dirname(absoluteInputPath); // Use absolute input path's dir\n+                const ext = path.extname(absoluteInputPath);\n+                const name = path.basename(absoluteInputPath, ext);\n+                outputPath = path.join(dir, `redacted-${name}.png`);\n+            }\n+\n+            // Convert base64 dataUrl to buffer and save\n+            const base64Data = result.dataUrl.replace(/^data:image\\/png;base64,/, \"\");","path":"src/cli.ts","commit_id":"fcf829233be16c2f5dac0353770a5550acd5b647","original_commit_id":"fcf829233be16c2f5dac0353770a5550acd5b647","user":{"login":"Copilot","id":175728472,"node_id":"BOT_kgDOCnlnWA","avatar_url":"https://avatars.githubusercontent.com/in/946600?v=4","gravatar_id":"","url":"https://api.github.com/users/Copilot","html_url":"https://github.com/apps/copilot-pull-request-reviewer","followers_url":"https://api.github.com/users/Copilot/followers","following_url":"https://api.github.com/users/Copilot/following{/other_user}","gists_url":"https://api.github.com/users/Copilot/gists{/gist_id}","starred_url":"https://api.github.com/users/Copilot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Copilot/subscriptions","organizations_url":"https://api.github.com/users/Copilot/orgs","repos_url":"https://api.github.com/users/Copilot/repos","events_url":"https://api.github.com/users/Copilot/events{/privacy}","received_events_url":"https://api.github.com/users/Copilot/received_events","type":"Bot","user_view_type":"public","site_admin":false},"body":"The base64 data URL regex replacement may fail for non-PNG images or malformed data URLs. The code assumes the data URL always starts with \"data:image/png;base64,\" but if the canvas generates a different format or if there's any variation in the prefix, the replacement will fail silently and write invalid data. Consider validating the data URL format before attempting the replacement or using a more robust parsing method.\n```suggestion\n            const match = result.dataUrl.match(/^data:image\\/[a-zA-Z0-9.+-]+;base64,(.*)$/);\n            if (!match) {\n                throw new Error(\"Invalid data URL format\");\n            }\n            const base64Data = match[1];\n```","created_at":"2025-12-13T02:59:48Z","updated_at":"2025-12-13T02:59:51Z","html_url":"https://github.com/karant-dev/AutoRedact/pull/21#discussion_r2616015880","pull_request_url":"https://api.github.com/repos/karant-dev/AutoRedact/pulls/21","_links":{"self":{"href":"https://api.github.com/repos/karant-dev/AutoRedact/pulls/comments/2616015880"},"html":{"href":"https://github.com/karant-dev/AutoRedact/pull/21#discussion_r2616015880"},"pull_request":{"href":"https://api.github.com/repos/karant-dev/AutoRedact/pulls/21"}},"reactions":{"url":"https://api.github.com/repos/karant-dev/AutoRedact/pulls/comments/2616015880/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"start_line":null,"original_start_line":null,"start_side":null,"line":114,"original_line":114,"side":"RIGHT","author_association":"NONE","original_position":114,"position":114,"subject_type":"line"},{"url":"https://api.github.com/repos/karant-dev/AutoRedact/pulls/comments/2616015883","pull_request_review_id":3574127511,"id":2616015883,"node_id":"PRRC_kwDOQm3mwc6b7TwL","diff_hunk":"@@ -0,0 +1,125 @@\n+#!/usr/bin/env node\n+\n+import { Command } from 'commander';\n+import chalk from 'chalk';\n+import path from 'path';\n+import fs from 'fs';\n+import { NodeCanvasAdapter } from './adapters/NodeCanvasAdapter';\n+import { processImage } from './core/processor';\n+import { DEFAULT_ALLOWLIST } from './constants/config';\n+import type { DetectionSettings } from './types';\n+\n+const program = new Command();\n+\n+program\n+    .name('auto-redact')\n+    .description('CLI for AutoRedact - Privacy-First OCR Redaction')\n+    .version('1.0.0');\n+\n+program\n+    .argument('<input>', 'Input image path')\n+    .option('-o, --output <path>', 'Output image path (default: redacted-<input>)')\n+    .option('--no-emails', 'Disable Email Redaction')\n+    .option('--no-ips', 'Disable IP Redaction')\n+    .option('--no-credit-cards', 'Disable Credit Card Redaction')\n+    .option('--no-secrets', 'Disable Secret/Key Redaction')\n+    .option('--no-pii', 'Disable PII Redaction')\n+    .option('--allowlist <items>', 'Comma separated list of allowed items')\n+    .option('--block-words <items>', 'Comma separated list of words to block')\n+    .option('--custom-dates <items>', 'Comma separated list of date formats')\n+    .option('--custom-regex <pattern...>', 'Custom Regex Pattern (can be repeated)')\n+    .action(async (inputPath, options) => {\n+        try {\n+            console.log(chalk.blue(`Processing: ${inputPath}...`));\n+\n+            // Fix for 'npm run': Resolve path relative to where the user actually ran the command (INIT_CWD),\n+            // not the project root where npm executes the script.\n+            const currentDir = process.env.INIT_CWD || process.cwd();\n+            const absoluteInputPath = path.resolve(currentDir, inputPath);\n+\n+            if (!fs.existsSync(absoluteInputPath)) {\n+                console.error(chalk.red(`Error: Input file detection failed at ${absoluteInputPath} (Original: ${inputPath})`));\n+                process.exit(1);\n+            }\n+\n+            const adapter = new NodeCanvasAdapter();\n+\n+            // Parse lists\n+            const allowlist = options.allowlist\n+                ? options.allowlist.split(',').map((s: string) => s.trim())\n+                : DEFAULT_ALLOWLIST;\n+\n+            const blockWords = options.blockWords\n+                ? options.blockWords.split(',').map((s: string) => s.trim())\n+                : [];\n+\n+            const customDates = options.customDates\n+                ? options.customDates.split(',').map((s: string) => s.trim())\n+                : [];\n+\n+            // Parse Custom Regex (Repeatable flag)\n+            // Commander 7+ handles variadic args if specified, or we might need to handle it differently depending on version.\n+            // Assuming string[] if repeated, or string if once.\n+            let customRegexRules: DetectionSettings['customRegex'] = [];\n+            if (options.customRegex) {\n+                const patterns = Array.isArray(options.customRegex) ? options.customRegex : [options.customRegex];\n+                customRegexRules = patterns.map((p: string, i: number) => ({\n+                    id: `cli-${i}`,\n+                    pattern: p,\n+                    caseSensitive: false, // Default to case-insensitive for CLI\n+                    label: `Custom Rule ${i + 1}`\n+                }));\n+            }\n+\n+            const result = await processImage(absoluteInputPath, {\n+                canvasFactory: adapter,\n+                detectionSettings: {\n+                    email: options.emails,\n+                    ip: options.ips,\n+                    creditCard: options.creditCards,\n+                    secret: options.secrets,\n+                    pii: options.pii,\n+                    allowlist: allowlist,\n+                    blockWords: blockWords,\n+                    customDates: customDates,\n+                    customRegex: customRegexRules\n+                },\n+                onProgress: (p) => {\n+                    process.stdout.write(`\\rOCR Progress: ${Math.round(p)}%`);\n+                }\n+            });\n+\n+            console.log(chalk.green('\\n\\nRedaction Complete! ✅'));\n+            console.log('--------------------------------');\n+            console.log(`Emails Found:       ${result.detectedBreakdown.emails}`);\n+            console.log(`IPs Found:          ${result.detectedBreakdown.ips}`);\n+            console.log(`Credit Cards Found: ${result.detectedBreakdown.creditCards}`);\n+            console.log(`Secrets Found:      ${result.detectedBreakdown.secrets}`);\n+            console.log(`PII/Other Found:    ${result.detectedBreakdown.pii}`);\n+            console.log('--------------------------------');\n+\n+            // Save Output\n+            let outputPath = options.output;\n+            if (outputPath) {\n+                // Fix for 'npm run': Resolve relative output path against user's CWD\n+                outputPath = path.resolve(currentDir, outputPath);\n+            } else {\n+                const dir = path.dirname(absoluteInputPath); // Use absolute input path's dir\n+                const ext = path.extname(absoluteInputPath);\n+                const name = path.basename(absoluteInputPath, ext);\n+                outputPath = path.join(dir, `redacted-${name}.png`);\n+            }\n+\n+            // Convert base64 dataUrl to buffer and save\n+            const base64Data = result.dataUrl.replace(/^data:image\\/png;base64,/, \"\");\n+            fs.writeFileSync(outputPath, base64Data, 'base64');","path":"src/cli.ts","commit_id":"fcf829233be16c2f5dac0353770a5550acd5b647","original_commit_id":"fcf829233be16c2f5dac0353770a5550acd5b647","user":{"login":"Copilot","id":175728472,"node_id":"BOT_kgDOCnlnWA","avatar_url":"https://avatars.githubusercontent.com/in/946600?v=4","gravatar_id":"","url":"https://api.github.com/users/Copilot","html_url":"https://github.com/apps/copilot-pull-request-reviewer","followers_url":"https://api.github.com/users/Copilot/followers","following_url":"https://api.github.com/users/Copilot/following{/other_user}","gists_url":"https://api.github.com/users/Copilot/gists{/gist_id}","starred_url":"https://api.github.com/users/Copilot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Copilot/subscriptions","organizations_url":"https://api.github.com/users/Copilot/orgs","repos_url":"https://api.github.com/users/Copilot/repos","events_url":"https://api.github.com/users/Copilot/events{/privacy}","received_events_url":"https://api.github.com/users/Copilot/received_events","type":"Bot","user_view_type":"public","site_admin":false},"body":"Missing error handling for file write operation. If the output directory doesn't exist or if the user lacks write permissions, fs.writeFileSync will throw an error, but it's caught by the generic catch block without providing specific guidance. Consider wrapping the file write operation in a try-catch block to provide a more informative error message about the specific file write failure.\n```suggestion\n            try {\n                fs.writeFileSync(outputPath, base64Data, 'base64');\n            } catch (fileError) {\n                console.error(chalk.red(`\\nFailed to write output file at ${outputPath}:`), fileError.message);\n                process.exit(1);\n            }\n```","created_at":"2025-12-13T02:59:49Z","updated_at":"2025-12-13T02:59:51Z","html_url":"https://github.com/karant-dev/AutoRedact/pull/21#discussion_r2616015883","pull_request_url":"https://api.github.com/repos/karant-dev/AutoRedact/pulls/21","_links":{"self":{"href":"https://api.github.com/repos/karant-dev/AutoRedact/pulls/comments/2616015883"},"html":{"href":"https://github.com/karant-dev/AutoRedact/pull/21#discussion_r2616015883"},"pull_request":{"href":"https://api.github.com/repos/karant-dev/AutoRedact/pulls/21"}},"reactions":{"url":"https://api.github.com/repos/karant-dev/AutoRedact/pulls/comments/2616015883/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"start_line":null,"original_start_line":null,"start_side":null,"line":115,"original_line":115,"side":"RIGHT","author_association":"NONE","original_position":115,"position":115,"subject_type":"line"},{"url":"https://api.github.com/repos/karant-dev/AutoRedact/pulls/comments/2616015890","pull_request_review_id":3574127511,"id":2616015890,"node_id":"PRRC_kwDOQm3mwc6b7TwS","diff_hunk":"@@ -0,0 +1,125 @@\n+#!/usr/bin/env node\n+\n+import { Command } from 'commander';\n+import chalk from 'chalk';\n+import path from 'path';\n+import fs from 'fs';\n+import { NodeCanvasAdapter } from './adapters/NodeCanvasAdapter';\n+import { processImage } from './core/processor';\n+import { DEFAULT_ALLOWLIST } from './constants/config';\n+import type { DetectionSettings } from './types';\n+\n+const program = new Command();\n+\n+program\n+    .name('auto-redact')\n+    .description('CLI for AutoRedact - Privacy-First OCR Redaction')\n+    .version('1.0.0');\n+\n+program\n+    .argument('<input>', 'Input image path')\n+    .option('-o, --output <path>', 'Output image path (default: redacted-<input>)')\n+    .option('--no-emails', 'Disable Email Redaction')\n+    .option('--no-ips', 'Disable IP Redaction')\n+    .option('--no-credit-cards', 'Disable Credit Card Redaction')\n+    .option('--no-secrets', 'Disable Secret/Key Redaction')\n+    .option('--no-pii', 'Disable PII Redaction')\n+    .option('--allowlist <items>', 'Comma separated list of allowed items')\n+    .option('--block-words <items>', 'Comma separated list of words to block')\n+    .option('--custom-dates <items>', 'Comma separated list of date formats')\n+    .option('--custom-regex <pattern...>', 'Custom Regex Pattern (can be repeated)')\n+    .action(async (inputPath, options) => {\n+        try {\n+            console.log(chalk.blue(`Processing: ${inputPath}...`));\n+\n+            // Fix for 'npm run': Resolve path relative to where the user actually ran the command (INIT_CWD),\n+            // not the project root where npm executes the script.\n+            const currentDir = process.env.INIT_CWD || process.cwd();\n+            const absoluteInputPath = path.resolve(currentDir, inputPath);\n+\n+            if (!fs.existsSync(absoluteInputPath)) {\n+                console.error(chalk.red(`Error: Input file detection failed at ${absoluteInputPath} (Original: ${inputPath})`));","path":"src/cli.ts","commit_id":"fcf829233be16c2f5dac0353770a5550acd5b647","original_commit_id":"fcf829233be16c2f5dac0353770a5550acd5b647","user":{"login":"Copilot","id":175728472,"node_id":"BOT_kgDOCnlnWA","avatar_url":"https://avatars.githubusercontent.com/in/946600?v=4","gravatar_id":"","url":"https://api.github.com/users/Copilot","html_url":"https://github.com/apps/copilot-pull-request-reviewer","followers_url":"https://api.github.com/users/Copilot/followers","following_url":"https://api.github.com/users/Copilot/following{/other_user}","gists_url":"https://api.github.com/users/Copilot/gists{/gist_id}","starred_url":"https://api.github.com/users/Copilot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Copilot/subscriptions","organizations_url":"https://api.github.com/users/Copilot/orgs","repos_url":"https://api.github.com/users/Copilot/repos","events_url":"https://api.github.com/users/Copilot/events{/privacy}","received_events_url":"https://api.github.com/users/Copilot/received_events","type":"Bot","user_view_type":"public","site_admin":false},"body":"The error message is unclear. \"Input file detection failed\" should be \"Input file not found\" to be more accurate and user-friendly.\n```suggestion\n                console.error(chalk.red(`Error: Input file not found at ${absoluteInputPath} (Original: ${inputPath})`));\n```","created_at":"2025-12-13T02:59:49Z","updated_at":"2025-12-13T02:59:51Z","html_url":"https://github.com/karant-dev/AutoRedact/pull/21#discussion_r2616015890","pull_request_url":"https://api.github.com/repos/karant-dev/AutoRedact/pulls/21","_links":{"self":{"href":"https://api.github.com/repos/karant-dev/AutoRedact/pulls/comments/2616015890"},"html":{"href":"https://github.com/karant-dev/AutoRedact/pull/21#discussion_r2616015890"},"pull_request":{"href":"https://api.github.com/repos/karant-dev/AutoRedact/pulls/21"}},"reactions":{"url":"https://api.github.com/repos/karant-dev/AutoRedact/pulls/comments/2616015890/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"start_line":null,"original_start_line":null,"start_side":null,"line":41,"original_line":41,"side":"RIGHT","author_association":"NONE","original_position":41,"position":41,"subject_type":"line"},{"url":"https://api.github.com/repos/karant-dev/AutoRedact/pulls/comments/2616015895","pull_request_review_id":3574127511,"id":2616015895,"node_id":"PRRC_kwDOQm3mwc6b7TwX","diff_hunk":"@@ -0,0 +1,125 @@\n+#!/usr/bin/env node\n+\n+import { Command } from 'commander';\n+import chalk from 'chalk';\n+import path from 'path';\n+import fs from 'fs';\n+import { NodeCanvasAdapter } from './adapters/NodeCanvasAdapter';\n+import { processImage } from './core/processor';\n+import { DEFAULT_ALLOWLIST } from './constants/config';\n+import type { DetectionSettings } from './types';\n+\n+const program = new Command();\n+\n+program\n+    .name('auto-redact')\n+    .description('CLI for AutoRedact - Privacy-First OCR Redaction')\n+    .version('1.0.0');\n+\n+program\n+    .argument('<input>', 'Input image path')\n+    .option('-o, --output <path>', 'Output image path (default: redacted-<input>)')\n+    .option('--no-emails', 'Disable Email Redaction')\n+    .option('--no-ips', 'Disable IP Redaction')\n+    .option('--no-credit-cards', 'Disable Credit Card Redaction')\n+    .option('--no-secrets', 'Disable Secret/Key Redaction')\n+    .option('--no-pii', 'Disable PII Redaction')\n+    .option('--allowlist <items>', 'Comma separated list of allowed items')\n+    .option('--block-words <items>', 'Comma separated list of words to block')\n+    .option('--custom-dates <items>', 'Comma separated list of date formats')\n+    .option('--custom-regex <pattern...>', 'Custom Regex Pattern (can be repeated)')\n+    .action(async (inputPath, options) => {\n+        try {\n+            console.log(chalk.blue(`Processing: ${inputPath}...`));\n+\n+            // Fix for 'npm run': Resolve path relative to where the user actually ran the command (INIT_CWD),\n+            // not the project root where npm executes the script.\n+            const currentDir = process.env.INIT_CWD || process.cwd();\n+            const absoluteInputPath = path.resolve(currentDir, inputPath);\n+","path":"src/cli.ts","commit_id":"fcf829233be16c2f5dac0353770a5550acd5b647","original_commit_id":"fcf829233be16c2f5dac0353770a5550acd5b647","user":{"login":"Copilot","id":175728472,"node_id":"BOT_kgDOCnlnWA","avatar_url":"https://avatars.githubusercontent.com/in/946600?v=4","gravatar_id":"","url":"https://api.github.com/users/Copilot","html_url":"https://github.com/apps/copilot-pull-request-reviewer","followers_url":"https://api.github.com/users/Copilot/followers","following_url":"https://api.github.com/users/Copilot/following{/other_user}","gists_url":"https://api.github.com/users/Copilot/gists{/gist_id}","starred_url":"https://api.github.com/users/Copilot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Copilot/subscriptions","organizations_url":"https://api.github.com/users/Copilot/orgs","repos_url":"https://api.github.com/users/Copilot/repos","events_url":"https://api.github.com/users/Copilot/events{/privacy}","received_events_url":"https://api.github.com/users/Copilot/received_events","type":"Bot","user_view_type":"public","site_admin":false},"body":"Potential path traversal vulnerability. The CLI uses process.env.INIT_CWD without validation and resolves paths based on user input. While path.resolve() normalizes paths, a malicious user could potentially access files outside the intended directory if INIT_CWD is manipulated or if the input path contains path traversal sequences. Consider validating that the resolved path is within expected bounds.\n```suggestion\n\n            // Path traversal protection: ensure input is within currentDir\n            const relative = path.relative(currentDir, absoluteInputPath);\n            if (relative.startsWith('..') || path.isAbsolute(relative)) {\n                console.error(chalk.red(`Error: Input path is outside the allowed directory (${currentDir}).`));\n                process.exit(1);\n            }\n```","created_at":"2025-12-13T02:59:49Z","updated_at":"2025-12-13T02:59:51Z","html_url":"https://github.com/karant-dev/AutoRedact/pull/21#discussion_r2616015895","pull_request_url":"https://api.github.com/repos/karant-dev/AutoRedact/pulls/21","_links":{"self":{"href":"https://api.github.com/repos/karant-dev/AutoRedact/pulls/comments/2616015895"},"html":{"href":"https://github.com/karant-dev/AutoRedact/pull/21#discussion_r2616015895"},"pull_request":{"href":"https://api.github.com/repos/karant-dev/AutoRedact/pulls/21"}},"reactions":{"url":"https://api.github.com/repos/karant-dev/AutoRedact/pulls/comments/2616015895/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"start_line":null,"original_start_line":null,"start_side":null,"line":39,"original_line":39,"side":"RIGHT","author_association":"NONE","original_position":39,"position":39,"subject_type":"line"},{"url":"https://api.github.com/repos/karant-dev/AutoRedact/pulls/comments/2616022418","pull_request_review_id":3574138582,"id":2616022418,"node_id":"PRRC_kwDOQm3mwc6b7VWS","diff_hunk":"@@ -6,9 +6,9 @@\n   \"scripts\": {\n     \"dev\": \"vite\",\n     \"build\": \"tsc -b && vite build\",\n-    \"license\": \"GPL-3.0\",\n-    \"lint\": \"eslint .\",\n+    \"lint\": \"eslint . --ext ts,tsx --report-unused-disable-directives --max-warnings 0\",","path":"package.json","commit_id":"fcf829233be16c2f5dac0353770a5550acd5b647","original_commit_id":"fcf829233be16c2f5dac0353770a5550acd5b647","user":{"login":"Copilot","id":175728472,"node_id":"BOT_kgDOCnlnWA","avatar_url":"https://avatars.githubusercontent.com/in/946600?v=4","gravatar_id":"","url":"https://api.github.com/users/Copilot","html_url":"https://github.com/apps/copilot-pull-request-reviewer","followers_url":"https://api.github.com/users/Copilot/followers","following_url":"https://api.github.com/users/Copilot/following{/other_user}","gists_url":"https://api.github.com/users/Copilot/gists{/gist_id}","starred_url":"https://api.github.com/users/Copilot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Copilot/subscriptions","organizations_url":"https://api.github.com/users/Copilot/orgs","repos_url":"https://api.github.com/users/Copilot/repos","events_url":"https://api.github.com/users/Copilot/events{/privacy}","received_events_url":"https://api.github.com/users/Copilot/received_events","type":"Bot","user_view_type":"public","site_admin":false},"body":"A line containing `\"license\": \"GPL-3.0\"` was removed from the scripts section. This line was incorrectly placed inside the scripts object (where it doesn't belong). While removing it is correct, ensure the license field exists at the root level of package.json (outside the diff context). If the license field doesn't exist elsewhere in package.json, it should be added at the root level.","created_at":"2025-12-13T03:12:38Z","updated_at":"2025-12-13T03:12:41Z","html_url":"https://github.com/karant-dev/AutoRedact/pull/21#discussion_r2616022418","pull_request_url":"https://api.github.com/repos/karant-dev/AutoRedact/pulls/21","_links":{"self":{"href":"https://api.github.com/repos/karant-dev/AutoRedact/pulls/comments/2616022418"},"html":{"href":"https://github.com/karant-dev/AutoRedact/pull/21#discussion_r2616022418"},"pull_request":{"href":"https://api.github.com/repos/karant-dev/AutoRedact/pulls/21"}},"reactions":{"url":"https://api.github.com/repos/karant-dev/AutoRedact/pulls/comments/2616022418/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"start_line":null,"original_start_line":null,"start_side":null,"line":9,"original_line":9,"side":"RIGHT","author_association":"NONE","original_position":6,"position":6,"subject_type":"line"},{"url":"https://api.github.com/repos/karant-dev/AutoRedact/pulls/comments/2616022419","pull_request_review_id":3574138582,"id":2616022419,"node_id":"PRRC_kwDOQm3mwc6b7VWT","diff_hunk":"@@ -18,6 +18,9 @@\n     ]\n   },\n   \"dependencies\": {\n+    \"canvas\": \"^3.2.0\",\n+    \"chalk\": \"^5.6.2\",\n+    \"commander\": \"^14.0.2\",","path":"package.json","commit_id":"fcf829233be16c2f5dac0353770a5550acd5b647","original_commit_id":"fcf829233be16c2f5dac0353770a5550acd5b647","user":{"login":"Copilot","id":175728472,"node_id":"BOT_kgDOCnlnWA","avatar_url":"https://avatars.githubusercontent.com/in/946600?v=4","gravatar_id":"","url":"https://api.github.com/users/Copilot","html_url":"https://github.com/apps/copilot-pull-request-reviewer","followers_url":"https://api.github.com/users/Copilot/followers","following_url":"https://api.github.com/users/Copilot/following{/other_user}","gists_url":"https://api.github.com/users/Copilot/gists{/gist_id}","starred_url":"https://api.github.com/users/Copilot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Copilot/subscriptions","organizations_url":"https://api.github.com/users/Copilot/orgs","repos_url":"https://api.github.com/users/Copilot/repos","events_url":"https://api.github.com/users/Copilot/events{/privacy}","received_events_url":"https://api.github.com/users/Copilot/received_events","type":"Bot","user_view_type":"public","site_admin":false},"body":"Version constraint mismatch: The `commander` package (v14.0.2) requires Node >=20, while the `canvas` package (v3.2.0) supports Node ^18.12.0 || >= 20.9.0. This means users on Node 18 (which canvas supports) cannot use the CLI due to commander's requirement. Consider downgrading commander to a version that supports Node 18, or document that the CLI requires Node 20+ while the web app works with Node 18+.\n```suggestion\n    \"commander\": \"^11.0.0\",\n```","created_at":"2025-12-13T03:12:38Z","updated_at":"2025-12-13T03:12:41Z","html_url":"https://github.com/karant-dev/AutoRedact/pull/21#discussion_r2616022419","pull_request_url":"https://api.github.com/repos/karant-dev/AutoRedact/pulls/21","_links":{"self":{"href":"https://api.github.com/repos/karant-dev/AutoRedact/pulls/comments/2616022419"},"html":{"href":"https://github.com/karant-dev/AutoRedact/pull/21#discussion_r2616022419"},"pull_request":{"href":"https://api.github.com/repos/karant-dev/AutoRedact/pulls/21"}},"reactions":{"url":"https://api.github.com/repos/karant-dev/AutoRedact/pulls/comments/2616022419/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"start_line":null,"original_start_line":null,"start_side":null,"line":23,"original_line":23,"side":"RIGHT","author_association":"NONE","original_position":18,"position":18,"subject_type":"line"},{"url":"https://api.github.com/repos/karant-dev/AutoRedact/pulls/comments/2616022421","pull_request_review_id":3574138582,"id":2616022421,"node_id":"PRRC_kwDOQm3mwc6b7VWV","diff_hunk":"@@ -36,6 +36,21 @@ docker compose up -d\n \n Open [http://localhost:5173](http://localhost:5173) and drop your images.\n \n+### Command Line Interface (CLI)\n+\n+AutoRedact now supports a fully offline CLI mode using the same powerful engine.\n+\n+```bash\n+# Process a single image\n+npm run cli -- input.jpg\n+\n+# Disable specific redactors\n+npm run cli -- input.jpg --no-emails --no-ips\n+\n+# Use custom rules\n+npm run cli -- input.jpg --block-words \"Confidential\" --custom-regex \"Project-\\d+\"","path":"README.md","commit_id":"fcf829233be16c2f5dac0353770a5550acd5b647","original_commit_id":"fcf829233be16c2f5dac0353770a5550acd5b647","user":{"login":"Copilot","id":175728472,"node_id":"BOT_kgDOCnlnWA","avatar_url":"https://avatars.githubusercontent.com/in/946600?v=4","gravatar_id":"","url":"https://api.github.com/users/Copilot","html_url":"https://github.com/apps/copilot-pull-request-reviewer","followers_url":"https://api.github.com/users/Copilot/followers","following_url":"https://api.github.com/users/Copilot/following{/other_user}","gists_url":"https://api.github.com/users/Copilot/gists{/gist_id}","starred_url":"https://api.github.com/users/Copilot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Copilot/subscriptions","organizations_url":"https://api.github.com/users/Copilot/orgs","repos_url":"https://api.github.com/users/Copilot/repos","events_url":"https://api.github.com/users/Copilot/events{/privacy}","received_events_url":"https://api.github.com/users/Copilot/received_events","type":"Bot","user_view_type":"public","site_admin":false},"body":"The CLI examples show flags like `--no-emails` and `--no-ips`, but also show `--block-words` and `--custom-regex`. The double dash syntax requires proper spacing. The example `npm run cli -- input.jpg --block-words \"Confidential\" --custom-regex \"Project-\\d+\"` should clarify that multiple values or proper quoting may be needed depending on the shell being used.","created_at":"2025-12-13T03:12:39Z","updated_at":"2025-12-13T03:12:41Z","html_url":"https://github.com/karant-dev/AutoRedact/pull/21#discussion_r2616022421","pull_request_url":"https://api.github.com/repos/karant-dev/AutoRedact/pulls/21","_links":{"self":{"href":"https://api.github.com/repos/karant-dev/AutoRedact/pulls/comments/2616022421"},"html":{"href":"https://github.com/karant-dev/AutoRedact/pull/21#discussion_r2616022421"},"pull_request":{"href":"https://api.github.com/repos/karant-dev/AutoRedact/pulls/21"}},"reactions":{"url":"https://api.github.com/repos/karant-dev/AutoRedact/pulls/comments/2616022421/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"start_line":50,"original_start_line":50,"start_side":"RIGHT","line":51,"original_line":51,"side":"RIGHT","author_association":"NONE","original_position":16,"position":16,"subject_type":"line"},{"url":"https://api.github.com/repos/karant-dev/AutoRedact/pulls/comments/2616022422","pull_request_review_id":3574138582,"id":2616022422,"node_id":"PRRC_kwDOQm3mwc6b7VWW","diff_hunk":"@@ -0,0 +1,24 @@\n+\n+// Abstract image type (Platform dependent: HTMLImageElement or Node Canvas Image)\n+export type AbstractImage = unknown;\n+\n+export interface ICanvasContext {\n+    drawImage(image: AbstractImage, dx: number, dy: number, dw?: number, dh?: number): void;\n+    getImageData(sx: number, sy: number, sw: number, sh: number): ImageData;\n+    putImageData(imageData: ImageData, dx: number, dy: number): void;\n+    fillStyle: string | CanvasGradient | CanvasPattern;\n+    fillRect(x: number, y: number, w: number, h: number): void;\n+}\n+\n+export interface ICanvas {\n+    width: number;\n+    height: number;\n+    getContext(contextId: '2d'): ICanvasContext | null;\n+    toDataURL(type?: string): string;\n+}\n+\n+export interface ICanvasFactory {\n+    createCanvas(width: number, height: number): ICanvas;\n+    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n+    loadImage(source: string | any): Promise<AbstractImage>;","path":"src/core/interfaces.ts","commit_id":"fcf829233be16c2f5dac0353770a5550acd5b647","original_commit_id":"fcf829233be16c2f5dac0353770a5550acd5b647","user":{"login":"Copilot","id":175728472,"node_id":"BOT_kgDOCnlnWA","avatar_url":"https://avatars.githubusercontent.com/in/946600?v=4","gravatar_id":"","url":"https://api.github.com/users/Copilot","html_url":"https://github.com/apps/copilot-pull-request-reviewer","followers_url":"https://api.github.com/users/Copilot/followers","following_url":"https://api.github.com/users/Copilot/following{/other_user}","gists_url":"https://api.github.com/users/Copilot/gists{/gist_id}","starred_url":"https://api.github.com/users/Copilot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Copilot/subscriptions","organizations_url":"https://api.github.com/users/Copilot/orgs","repos_url":"https://api.github.com/users/Copilot/repos","events_url":"https://api.github.com/users/Copilot/events{/privacy}","received_events_url":"https://api.github.com/users/Copilot/received_events","type":"Bot","user_view_type":"public","site_admin":false},"body":"The `ICanvasFactory.loadImage` method signature uses `any` type for the source parameter along with string. This overly permissive typing could lead to runtime errors if unsupported types are passed. Consider defining a union type like `string | Blob | File | Buffer` to provide better type safety while maintaining flexibility for both browser and Node environments.\n```suggestion\n    // Accepts common image source types for browser and Node environments\n    loadImage(source: string | Blob | File | Buffer): Promise<AbstractImage>;\n```","created_at":"2025-12-13T03:12:39Z","updated_at":"2025-12-13T03:12:41Z","html_url":"https://github.com/karant-dev/AutoRedact/pull/21#discussion_r2616022422","pull_request_url":"https://api.github.com/repos/karant-dev/AutoRedact/pulls/21","_links":{"self":{"href":"https://api.github.com/repos/karant-dev/AutoRedact/pulls/comments/2616022422"},"html":{"href":"https://github.com/karant-dev/AutoRedact/pull/21#discussion_r2616022422"},"pull_request":{"href":"https://api.github.com/repos/karant-dev/AutoRedact/pulls/21"}},"reactions":{"url":"https://api.github.com/repos/karant-dev/AutoRedact/pulls/comments/2616022422/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"start_line":22,"original_start_line":22,"start_side":"RIGHT","line":23,"original_line":23,"side":"RIGHT","author_association":"NONE","original_position":23,"position":23,"subject_type":"line"},{"url":"https://api.github.com/repos/karant-dev/AutoRedact/pulls/comments/2616022425","pull_request_review_id":3574138582,"id":2616022425,"node_id":"PRRC_kwDOQm3mwc6b7VWZ","diff_hunk":"@@ -0,0 +1,125 @@\n+#!/usr/bin/env node\n+\n+import { Command } from 'commander';\n+import chalk from 'chalk';\n+import path from 'path';\n+import fs from 'fs';\n+import { NodeCanvasAdapter } from './adapters/NodeCanvasAdapter';\n+import { processImage } from './core/processor';\n+import { DEFAULT_ALLOWLIST } from './constants/config';\n+import type { DetectionSettings } from './types';\n+\n+const program = new Command();\n+\n+program\n+    .name('auto-redact')\n+    .description('CLI for AutoRedact - Privacy-First OCR Redaction')\n+    .version('1.0.0');\n+\n+program\n+    .argument('<input>', 'Input image path')\n+    .option('-o, --output <path>', 'Output image path (default: redacted-<input>)')\n+    .option('--no-emails', 'Disable Email Redaction')\n+    .option('--no-ips', 'Disable IP Redaction')\n+    .option('--no-credit-cards', 'Disable Credit Card Redaction')\n+    .option('--no-secrets', 'Disable Secret/Key Redaction')\n+    .option('--no-pii', 'Disable PII Redaction')\n+    .option('--allowlist <items>', 'Comma separated list of allowed items')\n+    .option('--block-words <items>', 'Comma separated list of words to block')\n+    .option('--custom-dates <items>', 'Comma separated list of date formats')\n+    .option('--custom-regex <pattern...>', 'Custom Regex Pattern (can be repeated)')\n+    .action(async (inputPath, options) => {\n+        try {\n+            console.log(chalk.blue(`Processing: ${inputPath}...`));\n+\n+            // Fix for 'npm run': Resolve path relative to where the user actually ran the command (INIT_CWD),\n+            // not the project root where npm executes the script.\n+            const currentDir = process.env.INIT_CWD || process.cwd();\n+            const absoluteInputPath = path.resolve(currentDir, inputPath);\n+\n+            if (!fs.existsSync(absoluteInputPath)) {\n+                console.error(chalk.red(`Error: Input file detection failed at ${absoluteInputPath} (Original: ${inputPath})`));","path":"src/cli.ts","commit_id":"fcf829233be16c2f5dac0353770a5550acd5b647","original_commit_id":"fcf829233be16c2f5dac0353770a5550acd5b647","user":{"login":"Copilot","id":175728472,"node_id":"BOT_kgDOCnlnWA","avatar_url":"https://avatars.githubusercontent.com/in/946600?v=4","gravatar_id":"","url":"https://api.github.com/users/Copilot","html_url":"https://github.com/apps/copilot-pull-request-reviewer","followers_url":"https://api.github.com/users/Copilot/followers","following_url":"https://api.github.com/users/Copilot/following{/other_user}","gists_url":"https://api.github.com/users/Copilot/gists{/gist_id}","starred_url":"https://api.github.com/users/Copilot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Copilot/subscriptions","organizations_url":"https://api.github.com/users/Copilot/orgs","repos_url":"https://api.github.com/users/Copilot/repos","events_url":"https://api.github.com/users/Copilot/events{/privacy}","received_events_url":"https://api.github.com/users/Copilot/received_events","type":"Bot","user_view_type":"public","site_admin":false},"body":"The error message incorrectly says \"Input file detection failed\" when it should say \"Input file not found\" or \"Input file does not exist\". The word \"detection\" suggests the file detection logic failed, not that the file is missing.\n```suggestion\n                console.error(chalk.red(`Error: Input file not found at ${absoluteInputPath} (Original: ${inputPath})`));\n```","created_at":"2025-12-13T03:12:39Z","updated_at":"2025-12-13T03:12:41Z","html_url":"https://github.com/karant-dev/AutoRedact/pull/21#discussion_r2616022425","pull_request_url":"https://api.github.com/repos/karant-dev/AutoRedact/pulls/21","_links":{"self":{"href":"https://api.github.com/repos/karant-dev/AutoRedact/pulls/comments/2616022425"},"html":{"href":"https://github.com/karant-dev/AutoRedact/pull/21#discussion_r2616022425"},"pull_request":{"href":"https://api.github.com/repos/karant-dev/AutoRedact/pulls/21"}},"reactions":{"url":"https://api.github.com/repos/karant-dev/AutoRedact/pulls/comments/2616022425/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"start_line":null,"original_start_line":null,"start_side":null,"line":41,"original_line":41,"side":"RIGHT","author_association":"NONE","original_position":41,"position":41,"subject_type":"line"},{"url":"https://api.github.com/repos/karant-dev/AutoRedact/pulls/comments/2616022426","pull_request_review_id":3574138582,"id":2616022426,"node_id":"PRRC_kwDOQm3mwc6b7VWa","diff_hunk":"@@ -0,0 +1,125 @@\n+#!/usr/bin/env node\n+\n+import { Command } from 'commander';\n+import chalk from 'chalk';\n+import path from 'path';\n+import fs from 'fs';\n+import { NodeCanvasAdapter } from './adapters/NodeCanvasAdapter';\n+import { processImage } from './core/processor';\n+import { DEFAULT_ALLOWLIST } from './constants/config';\n+import type { DetectionSettings } from './types';\n+\n+const program = new Command();\n+\n+program\n+    .name('auto-redact')\n+    .description('CLI for AutoRedact - Privacy-First OCR Redaction')\n+    .version('1.0.0');\n+\n+program\n+    .argument('<input>', 'Input image path')\n+    .option('-o, --output <path>', 'Output image path (default: redacted-<input>)')\n+    .option('--no-emails', 'Disable Email Redaction')\n+    .option('--no-ips', 'Disable IP Redaction')\n+    .option('--no-credit-cards', 'Disable Credit Card Redaction')\n+    .option('--no-secrets', 'Disable Secret/Key Redaction')\n+    .option('--no-pii', 'Disable PII Redaction')\n+    .option('--allowlist <items>', 'Comma separated list of allowed items')\n+    .option('--block-words <items>', 'Comma separated list of words to block')\n+    .option('--custom-dates <items>', 'Comma separated list of date formats')\n+    .option('--custom-regex <pattern...>', 'Custom Regex Pattern (can be repeated)')\n+    .action(async (inputPath, options) => {\n+        try {\n+            console.log(chalk.blue(`Processing: ${inputPath}...`));\n+\n+            // Fix for 'npm run': Resolve path relative to where the user actually ran the command (INIT_CWD),\n+            // not the project root where npm executes the script.\n+            const currentDir = process.env.INIT_CWD || process.cwd();\n+            const absoluteInputPath = path.resolve(currentDir, inputPath);\n+\n+            if (!fs.existsSync(absoluteInputPath)) {\n+                console.error(chalk.red(`Error: Input file detection failed at ${absoluteInputPath} (Original: ${inputPath})`));\n+                process.exit(1);\n+            }\n+\n+            const adapter = new NodeCanvasAdapter();\n+\n+            // Parse lists\n+            const allowlist = options.allowlist\n+                ? options.allowlist.split(',').map((s: string) => s.trim())\n+                : DEFAULT_ALLOWLIST;\n+\n+            const blockWords = options.blockWords\n+                ? options.blockWords.split(',').map((s: string) => s.trim())\n+                : [];\n+\n+            const customDates = options.customDates\n+                ? options.customDates.split(',').map((s: string) => s.trim())\n+                : [];\n+\n+            // Parse Custom Regex (Repeatable flag)\n+            // Commander 7+ handles variadic args if specified, or we might need to handle it differently depending on version.\n+            // Assuming string[] if repeated, or string if once.\n+            let customRegexRules: DetectionSettings['customRegex'] = [];\n+            if (options.customRegex) {\n+                const patterns = Array.isArray(options.customRegex) ? options.customRegex : [options.customRegex];\n+                customRegexRules = patterns.map((p: string, i: number) => ({\n+                    id: `cli-${i}`,\n+                    pattern: p,\n+                    caseSensitive: false, // Default to case-insensitive for CLI\n+                    label: `Custom Rule ${i + 1}`\n+                }));\n+            }\n+\n+            const result = await processImage(absoluteInputPath, {\n+                canvasFactory: adapter,\n+                detectionSettings: {\n+                    email: options.emails,\n+                    ip: options.ips,\n+                    creditCard: options.creditCards,\n+                    secret: options.secrets,\n+                    pii: options.pii,\n+                    allowlist: allowlist,\n+                    blockWords: blockWords,\n+                    customDates: customDates,\n+                    customRegex: customRegexRules","path":"src/cli.ts","commit_id":"fcf829233be16c2f5dac0353770a5550acd5b647","original_commit_id":"fcf829233be16c2f5dac0353770a5550acd5b647","user":{"login":"Copilot","id":175728472,"node_id":"BOT_kgDOCnlnWA","avatar_url":"https://avatars.githubusercontent.com/in/946600?v=4","gravatar_id":"","url":"https://api.github.com/users/Copilot","html_url":"https://github.com/apps/copilot-pull-request-reviewer","followers_url":"https://api.github.com/users/Copilot/followers","following_url":"https://api.github.com/users/Copilot/following{/other_user}","gists_url":"https://api.github.com/users/Copilot/gists{/gist_id}","starred_url":"https://api.github.com/users/Copilot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Copilot/subscriptions","organizations_url":"https://api.github.com/users/Copilot/orgs","repos_url":"https://api.github.com/users/Copilot/repos","events_url":"https://api.github.com/users/Copilot/events{/privacy}","received_events_url":"https://api.github.com/users/Copilot/received_events","type":"Bot","user_view_type":"public","site_admin":false},"body":"The function checks for specific boolean properties like `options.emails`, `options.ips`, etc., but these properties are created by negation options (--no-emails, --no-ips). Commander sets these to `false` when the flag is present, but they will be `undefined` when not present. The code should explicitly check for `options.emails !== false` instead of truthy values, or provide explicit defaults. Currently, if none of the --no-* flags are specified, all values will be undefined and treated as falsy, potentially disabling all detection.","created_at":"2025-12-13T03:12:39Z","updated_at":"2025-12-13T03:12:41Z","html_url":"https://github.com/karant-dev/AutoRedact/pull/21#discussion_r2616022426","pull_request_url":"https://api.github.com/repos/karant-dev/AutoRedact/pulls/21","_links":{"self":{"href":"https://api.github.com/repos/karant-dev/AutoRedact/pulls/comments/2616022426"},"html":{"href":"https://github.com/karant-dev/AutoRedact/pull/21#discussion_r2616022426"},"pull_request":{"href":"https://api.github.com/repos/karant-dev/AutoRedact/pulls/21"}},"reactions":{"url":"https://api.github.com/repos/karant-dev/AutoRedact/pulls/comments/2616022426/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"start_line":76,"original_start_line":76,"start_side":"RIGHT","line":85,"original_line":85,"side":"RIGHT","author_association":"NONE","original_position":85,"position":85,"subject_type":"line"},{"url":"https://api.github.com/repos/karant-dev/AutoRedact/pulls/comments/2616022428","pull_request_review_id":3574138582,"id":2616022428,"node_id":"PRRC_kwDOQm3mwc6b7VWc","diff_hunk":"@@ -0,0 +1,17 @@\n+import { createCanvas, loadImage } from 'canvas';\n+import type { ICanvasFactory, ICanvas, AbstractImage } from '../core/interfaces';\n+\n+export class NodeCanvasAdapter implements ICanvasFactory {\n+    createCanvas(width: number, height: number): ICanvas {\n+        // cast to any because node-canvas keys slightly differ from strict DOM types but are compatible at runtime","path":"src/adapters/NodeCanvasAdapter.ts","commit_id":"fcf829233be16c2f5dac0353770a5550acd5b647","original_commit_id":"fcf829233be16c2f5dac0353770a5550acd5b647","user":{"login":"Copilot","id":175728472,"node_id":"BOT_kgDOCnlnWA","avatar_url":"https://avatars.githubusercontent.com/in/946600?v=4","gravatar_id":"","url":"https://api.github.com/users/Copilot","html_url":"https://github.com/apps/copilot-pull-request-reviewer","followers_url":"https://api.github.com/users/Copilot/followers","following_url":"https://api.github.com/users/Copilot/following{/other_user}","gists_url":"https://api.github.com/users/Copilot/gists{/gist_id}","starred_url":"https://api.github.com/users/Copilot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Copilot/subscriptions","organizations_url":"https://api.github.com/users/Copilot/orgs","repos_url":"https://api.github.com/users/Copilot/repos","events_url":"https://api.github.com/users/Copilot/events{/privacy}","received_events_url":"https://api.github.com/users/Copilot/received_events","type":"Bot","user_view_type":"public","site_admin":false},"body":"The comment says \"cast to any because node-canvas keys slightly differ from strict DOM types but are compatible at runtime\". However, the code casts to `unknown` first, then to `ICanvas`, which is the proper way to handle this. The comment should be updated to accurately reflect that the code uses `unknown` as an intermediate cast, not `any`.\n```suggestion\n        // cast to unknown first, then to ICanvas, because node-canvas keys slightly differ from strict DOM types but are compatible at runtime\n```","created_at":"2025-12-13T03:12:40Z","updated_at":"2025-12-13T03:12:41Z","html_url":"https://github.com/karant-dev/AutoRedact/pull/21#discussion_r2616022428","pull_request_url":"https://api.github.com/repos/karant-dev/AutoRedact/pulls/21","_links":{"self":{"href":"https://api.github.com/repos/karant-dev/AutoRedact/pulls/comments/2616022428"},"html":{"href":"https://github.com/karant-dev/AutoRedact/pull/21#discussion_r2616022428"},"pull_request":{"href":"https://api.github.com/repos/karant-dev/AutoRedact/pulls/21"}},"reactions":{"url":"https://api.github.com/repos/karant-dev/AutoRedact/pulls/comments/2616022428/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"start_line":null,"original_start_line":null,"start_side":null,"line":6,"original_line":6,"side":"RIGHT","author_association":"NONE","original_position":6,"position":6,"subject_type":"line"},{"url":"https://api.github.com/repos/karant-dev/AutoRedact/pulls/comments/2616022430","pull_request_review_id":3574138582,"id":2616022430,"node_id":"PRRC_kwDOQm3mwc6b7VWe","diff_hunk":"@@ -56,9 +71,11 @@ Open [http://localhost:5173](http://localhost:5173) and drop your images.\n \n ```text\n src/\n+├── adapters/     # Interface implementations (Browser/Node)\n ├── components/   # UI Components\n+├── core/         # Pure Logic (Regex, Math, Image Proc)\n ├── hooks/        # Custom Hooks\n-├── utils/        # Logic & Helpers\n+├── utils/        # Helpers\n ├── types/        # TS Interfaces","path":"README.md","commit_id":"fcf829233be16c2f5dac0353770a5550acd5b647","original_commit_id":"fcf829233be16c2f5dac0353770a5550acd5b647","user":{"login":"Copilot","id":175728472,"node_id":"BOT_kgDOCnlnWA","avatar_url":"https://avatars.githubusercontent.com/in/946600?v=4","gravatar_id":"","url":"https://api.github.com/users/Copilot","html_url":"https://github.com/apps/copilot-pull-request-reviewer","followers_url":"https://api.github.com/users/Copilot/followers","following_url":"https://api.github.com/users/Copilot/following{/other_user}","gists_url":"https://api.github.com/users/Copilot/gists{/gist_id}","starred_url":"https://api.github.com/users/Copilot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Copilot/subscriptions","organizations_url":"https://api.github.com/users/Copilot/orgs","repos_url":"https://api.github.com/users/Copilot/repos","events_url":"https://api.github.com/users/Copilot/events{/privacy}","received_events_url":"https://api.github.com/users/Copilot/received_events","type":"Bot","user_view_type":"public","site_admin":false},"body":"Missing entry in directory structure: The new `src/cli.ts` file is not mentioned in the directory structure diagram. Since it's a significant addition that implements the CLI functionality, it should be included (perhaps as `├── cli.ts # CLI Entry Point`).\n```suggestion\n├── types/        # TS Interfaces\n├── cli.ts        # CLI Entry Point\n```","created_at":"2025-12-13T03:12:40Z","updated_at":"2025-12-13T03:12:41Z","html_url":"https://github.com/karant-dev/AutoRedact/pull/21#discussion_r2616022430","pull_request_url":"https://api.github.com/repos/karant-dev/AutoRedact/pulls/21","_links":{"self":{"href":"https://api.github.com/repos/karant-dev/AutoRedact/pulls/comments/2616022430"},"html":{"href":"https://github.com/karant-dev/AutoRedact/pull/21#discussion_r2616022430"},"pull_request":{"href":"https://api.github.com/repos/karant-dev/AutoRedact/pulls/21"}},"reactions":{"url":"https://api.github.com/repos/karant-dev/AutoRedact/pulls/comments/2616022430/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"start_line":null,"original_start_line":null,"start_side":null,"line":79,"original_line":79,"side":"RIGHT","author_association":"NONE","original_position":32,"position":32,"subject_type":"line"},{"url":"https://api.github.com/repos/karant-dev/AutoRedact/pulls/comments/2616022432","pull_request_review_id":3574138582,"id":2616022432,"node_id":"PRRC_kwDOQm3mwc6b7VWg","diff_hunk":"@@ -0,0 +1,214 @@\n+import { createWorker } from 'tesseract.js';\n+import type { DetectedItem, DetectionSettings } from '../types';\n+import type { ICanvasFactory, AbstractImage } from './interfaces';\n+import { preprocessImage } from './image-processing';\n+import {\n+    findMatches,\n+    findBlockWordMatches,\n+    findCustomDateMatches,\n+    findCustomRegexMatches,\n+    filterAllowlistedMatches,\n+    hasValidOverlap\n+} from './matcher';\n+import { SENSITIVE_PATTERNS } from '../constants/patterns';\n+import { DEFAULT_ALLOWLIST } from '../constants/config';\n+\n+// Default settings\n+const DEFAULT_DETECTION_SETTINGS: DetectionSettings = {\n+    email: true,\n+    ip: true,\n+    creditCard: true,\n+    secret: true,\n+    pii: true,\n+    allowlist: DEFAULT_ALLOWLIST,\n+    blockWords: [],\n+    customDates: [],\n+    customRegex: [],\n+};\n+\n+export interface ProcessImageOptions {\n+    canvasFactory: ICanvasFactory;\n+    onProgress?: (progress: number) => void;\n+    detectionSettings?: DetectionSettings;\n+}\n+\n+export interface ScanResult {\n+    detectedCount: number;\n+    detectedBreakdown: {\n+        emails: number;\n+        ips: number;\n+        creditCards: number;\n+        secrets: number;\n+        pii: number;\n+    };\n+    dataUrl: string;\n+}\n+\n+export const processImage = async (\n+    source: string | Blob | File,\n+    options: ProcessImageOptions\n+): Promise<ScanResult> => {\n+    const {\n+        canvasFactory,\n+        onProgress,\n+        detectionSettings = DEFAULT_DETECTION_SETTINGS\n+    } = options;\n+\n+    // 1. Load Image using Adapter\n+    // Returns an abstract image object (HTMLImageElement in browser, Image in node-canvas)\n+    const img = await canvasFactory.loadImage(source);\n+\n+    // 2. Prepare Canvas Dimensions (Upscale 2x for OCR)\n+    const scale = 2;\n+    // In BrowserAdapter, img has naturalWidth/Height. In Node, it acts similarly.\n+    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n+    const width = (img as any).naturalWidth || (img as any).width;\n+    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n+    const height = (img as any).naturalHeight || (img as any).height;\n+\n+    const upscaledW = width * scale;\n+    const upscaledH = height * scale;\n+\n+    // 3. Create Canvases\n+    const upscaledCanvas = canvasFactory.createCanvas(upscaledW, upscaledH);\n+    const upscaledCtx = upscaledCanvas.getContext('2d');\n+\n+    const ocrCanvas = canvasFactory.createCanvas(upscaledW, upscaledH);\n+    const ocrCtx = ocrCanvas.getContext('2d');\n+\n+    if (!upscaledCtx || !ocrCtx) {\n+        throw new Error('Failed to create canvas contexts');\n+    }\n+\n+    // 4. Draw & Preprocess\n+    // Layer 1: Draw original to upscaled (Color version)\n+    upscaledCtx.drawImage(img, 0, 0, upscaledW, upscaledH);\n+\n+    // Layer 2: Copy to OCR canvas\n+    ocrCtx.drawImage(upscaledCanvas as unknown as AbstractImage, 0, 0);\n+\n+    // Layer 3: Apply Preprocessing (B&W) to OCR canvas only\n+    preprocessImage(ocrCtx, upscaledW, upscaledH);\n+    const ocrUrl = ocrCanvas.toDataURL('image/png');\n+\n+    // 5. Run Tesseract (WASM/Node)\n+    const worker = await createWorker('eng', 1, {\n+        logger: (m) => {\n+            if (m.status === 'recognizing text' && onProgress) {\n+                onProgress(m.progress * 100);\n+            }\n+        },\n+    });\n+\n+    const result = await worker.recognize(ocrUrl, {}, { blocks: true });\n+\n+    // 6. Detection Logic\n+    const detected: DetectedItem[] = [];\n+    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n+    const data = result.data as any;\n+    const fullText = data.text || '';\n+\n+    // --- MATCHING LOGIC (Copied from utils/ocr.ts) ---\n+    const emailMatches = detectionSettings.email ? findMatches(SENSITIVE_PATTERNS.email, fullText, 'email') : [];\n+\n+    const ipv4Matches = detectionSettings.ip ? findMatches(SENSITIVE_PATTERNS.ipv4, fullText, 'ip').filter(m => m.text.split('.').length === 4) : [];\n+    const ipv6Matches = detectionSettings.ip ? findMatches(SENSITIVE_PATTERNS.ipv6, fullText, 'ip') : [];\n+    const macMatches = detectionSettings.ip ? findMatches(SENSITIVE_PATTERNS.mac, fullText, 'ip') : [];\n+    const ipMatches = [...ipv4Matches, ...ipv6Matches, ...macMatches];\n+\n+    const ccBasicMatches = detectionSettings.creditCard ? findMatches(SENSITIVE_PATTERNS.creditCard, fullText, 'creditCard') : [];\n+    const ibanMatches = detectionSettings.creditCard ? findMatches(SENSITIVE_PATTERNS.iban, fullText, 'creditCard') : [];\n+    const btcMatches = detectionSettings.creditCard ? findMatches(SENSITIVE_PATTERNS.bitcoin, fullText, 'creditCard') : [];\n+    const ccMatches = [...ccBasicMatches, ...ibanMatches, ...btcMatches];\n+\n+    const ssnMatches = detectionSettings.pii ? findMatches(SENSITIVE_PATTERNS.ssn, fullText, 'pii') : [];\n+    const panMatches = detectionSettings.pii ? findMatches(SENSITIVE_PATTERNS.pan, fullText, 'pii') : [];\n+    const piiMatches = [...ssnMatches, ...panMatches];\n+\n+    let secretMatches: Array<{ text: string, type: DetectedItem['type'], index: number }> = [];\n+    if (detectionSettings.secret) {\n+        SENSITIVE_PATTERNS.secrets.forEach(pattern => {\n+            secretMatches = [...secretMatches, ...findMatches(pattern, fullText, 'secret')];\n+        });\n+    }\n+\n+    const blockWordMatches = detectionSettings.blockWords ? findBlockWordMatches(detectionSettings.blockWords, fullText, 'pii') : [];\n+    const customDateMatches = detectionSettings.customDates ? findCustomDateMatches(detectionSettings.customDates, fullText, 'pii') : [];\n+    const customRegexMatches = detectionSettings.customRegex ? findCustomRegexMatches(detectionSettings.customRegex, fullText, 'pii') : [];\n+    const customMatches = [...blockWordMatches, ...customDateMatches, ...customRegexMatches];\n+\n+    // Filter\n+    const allowlist = detectionSettings.allowlist || [];\n+    const filteredEmailMatches = filterAllowlistedMatches(emailMatches, allowlist);\n+    const filteredIpMatches = filterAllowlistedMatches(ipMatches, allowlist);\n+    const filteredCcMatches = filterAllowlistedMatches(ccMatches, allowlist);\n+    const filteredPiiMatches = filterAllowlistedMatches(piiMatches, allowlist);\n+    const filteredSecretMatches = filterAllowlistedMatches(secretMatches, allowlist);\n+    const filteredCustomMatches = filterAllowlistedMatches(customMatches, allowlist);\n+\n+    const allMatches = [...filteredEmailMatches, ...filteredIpMatches, ...filteredCcMatches, ...filteredPiiMatches, ...filteredSecretMatches, ...filteredCustomMatches];\n+\n+    // Stats\n+    const detectedBreakdown = {\n+        emails: filteredEmailMatches.length,\n+        ips: filteredIpMatches.length,\n+        creditCards: filteredCcMatches.length,\n+        secrets: filteredSecretMatches.length,\n+        pii: filteredPiiMatches.length + filteredCustomMatches.length,\n+    };\n+    const detectedCount = Object.values(detectedBreakdown).reduce((a, b) => a + b, 0);\n+\n+    // 7. Bounding Box Mapping\n+    const blocks = data.blocks || [];\n+    if (blocks.length > 0) {\n+        let cursor = 0;\n+        for (const block of blocks) {\n+            for (const paragraph of (block.paragraphs || [])) {\n+                for (const line of (paragraph.lines || [])) {\n+                    for (const word of (line.words || [])) {\n+                        const wordText = word.text?.trim();\n+                        if (!wordText) continue;\n+\n+                        const index = fullText.indexOf(wordText, cursor);\n+                        if (index !== -1) {\n+                            const wordStart = index;\n+                            const wordEnd = index + wordText.length;\n+                            const match = allMatches.find(m =>\n+                                hasValidOverlap(wordStart, wordEnd, wordText, m.index, m.index + m.text.length, m.text)\n+                            );\n+\n+                            if (match) {\n+                                detected.push({ text: wordText, type: match.type, bbox: word.bbox });\n+                            }\n+                            cursor = wordEnd;\n+                        }\n+                    }\n+                }\n+            }\n+        }\n+    }\n+\n+    await worker.terminate();\n+\n+    // 8. Redact (Draw on Upscaled Canvas)\n+    upscaledCtx.fillStyle = '#000000';\n+    detected.forEach(item => {\n+        const { x0, y0, x1, y1 } = item.bbox;\n+        upscaledCtx.fillRect(x0 - 2, y0 - 2, (x1 - x0) + 4, (y1 - y0) + 4);\n+    });\n+\n+    // 9. Downscale / Output\n+    const outputCanvas = canvasFactory.createCanvas(width, height);\n+    const outputCtx = outputCanvas.getContext('2d');\n+    if (outputCtx) {\n+        // cast upscaledCanvas to 'any' because strict ICanvas might NOT be exactly what drawImage expects in all adapters\n+        // but typically adapters handle this.","path":"src/core/processor.ts","commit_id":"fcf829233be16c2f5dac0353770a5550acd5b647","original_commit_id":"fcf829233be16c2f5dac0353770a5550acd5b647","user":{"login":"Copilot","id":175728472,"node_id":"BOT_kgDOCnlnWA","avatar_url":"https://avatars.githubusercontent.com/in/946600?v=4","gravatar_id":"","url":"https://api.github.com/users/Copilot","html_url":"https://github.com/apps/copilot-pull-request-reviewer","followers_url":"https://api.github.com/users/Copilot/followers","following_url":"https://api.github.com/users/Copilot/following{/other_user}","gists_url":"https://api.github.com/users/Copilot/gists{/gist_id}","starred_url":"https://api.github.com/users/Copilot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Copilot/subscriptions","organizations_url":"https://api.github.com/users/Copilot/orgs","repos_url":"https://api.github.com/users/Copilot/repos","events_url":"https://api.github.com/users/Copilot/events{/privacy}","received_events_url":"https://api.github.com/users/Copilot/received_events","type":"Bot","user_view_type":"public","site_admin":false},"body":"Inconsistent comment style: Line 204 says \"cast upscaledCanvas to 'any'\" but the code actually casts to `unknown` as an intermediate step (which is the correct approach). The comment should be updated to reflect the actual casting strategy used.\n```suggestion\n        // Cast upscaledCanvas to AbstractImage via 'unknown' as an intermediate step,\n        // because strict ICanvas might NOT be exactly what drawImage expects in all adapters.\n        // This is a common TypeScript pattern to force a type conversion; typically adapters handle this.\n```","created_at":"2025-12-13T03:12:40Z","updated_at":"2025-12-13T03:12:41Z","html_url":"https://github.com/karant-dev/AutoRedact/pull/21#discussion_r2616022432","pull_request_url":"https://api.github.com/repos/karant-dev/AutoRedact/pulls/21","_links":{"self":{"href":"https://api.github.com/repos/karant-dev/AutoRedact/pulls/comments/2616022432"},"html":{"href":"https://github.com/karant-dev/AutoRedact/pull/21#discussion_r2616022432"},"pull_request":{"href":"https://api.github.com/repos/karant-dev/AutoRedact/pulls/21"}},"reactions":{"url":"https://api.github.com/repos/karant-dev/AutoRedact/pulls/comments/2616022432/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"start_line":204,"original_start_line":204,"start_side":"RIGHT","line":205,"original_line":205,"side":"RIGHT","author_association":"NONE","original_position":205,"position":205,"subject_type":"line"}]